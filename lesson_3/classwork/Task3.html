<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Task 3</title>
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="wrap" id="wrap">
      <h1>Переключение слайдера</h1>
      <div class="roadMap__container yellow">
        <button class="navButton" data-direction="<"> Prev </button>
        <div class="roadMap">
          <div class="roadMapPoint" data-id="1"></div>
          <div class="roadMapPoint ball" data-id="2"></div>
          <div class="roadMapPoint" data-id="3"></div>
          <div class="roadMapPoint" data-id="4"></div>
          <div class="roadMapPoint" data-id="5"></div>
          <div class="roadMapPoint" data-id="6"></div>
          <div class="roadMapPoint" data-id="7"></div>
          <div class="roadMapPoint" data-id="8"></div>
        </div>
        <button class="navButton" data-direction=">"> Next </button>
      </div>

      <div class="roadMap__container red">
        <button class="navButton" data-direction="<"> Prev </button>
        <div class="roadMap">
          <div class="roadMapPoint" data-id="1"></div>
          <div class="roadMapPoint" data-id="2"></div>
          <div class="roadMapPoint ball" data-id="3"></div>
          <div class="roadMapPoint" data-id="4"></div>
        </div>
        <button class="navButton" data-direction=">"> Next </button>
      </div>

      <div class="roadMap__container blue">
        <button class="navButton" data-direction="<"> Prev </button>
        <div class="roadMap">
          <div class="roadMapPoint" data-id="1"></div>
          <div class="roadMapPoint ball" data-id="2"></div>
          <div class="roadMapPoint" data-id="3"></div>
          <div class="roadMapPoint" data-id="4"></div>
        </div>
        <button class="navButton" data-direction=">"> Next </button>
      </div>


      <div class="roadMap__container red">
          <button class="navButton" data-direction="<"> Prev </button>
          <div class="roadMap">
            <div class="roadMapPoint" data-id="1"></div>
            <div class="roadMapPoint" data-id="2"></div>
            <div class="roadMapPoint ball" data-id="3"></div>
            <div class="roadMapPoint" data-id="4"></div>
          </div>
          <button class="navButton" data-direction=">"> Next </button>
        </div>
  
        <div class="roadMap__container blue">
          <button class="navButton" data-direction="<"> Prev </button>
          <div class="roadMap">
            <div class="roadMapPoint" data-id="1"></div>
            <div class="roadMapPoint ball" data-id="2"></div>
            <div class="roadMapPoint" data-id="3"></div>
            <div class="roadMapPoint" data-id="4"></div>
          </div>
          <button class="navButton" data-direction=">"> Next </button>
        </div>

    </div>
    <script>

      /*
       Задание:

       Написать скрипт, который будет приводить в действие переключалки из разметки.
       И будет перемещать класс ball по точкам в зависимости от нажатой кнопки

     */

      let containers = document.querySelectorAll('.roadMap__container');

      containers.forEach( ( container )=> container.addEventListener('click', function (event){
        let ballArray = this.querySelectorAll('.roadMapPoint');

        let buttonList = this.querySelectorAll('.navButton');
        Array.from(buttonList);
        
        buttonList[1].addEventListener('click', nextFunction );

        buttonList[0].addEventListener('click', prevFunction );

        function nextFunction(event){
          event.stopPropagation();
          buttonList[0].removeAttribute("disabled");
          let ball = container.querySelector('.ball');
          let num = ball.dataset.id;
            parseInt(num);
          ballArray[num-1].classList.toggle('ball');
          ballArray[num].classList.toggle('ball');
          num++;

          if(num == ballArray.length){
            buttonList[1].removeEventListener('click',nextFunction);
            buttonList[1].setAttribute("disabled","true");
            buttonList[0].removeAttribute("disabled");
          }

        }

        function prevFunction(event){
          event.stopPropagation();
          let ball = container.querySelector('.ball');
          let num = ball.dataset.id;
          parseInt(num);

          ballArray[num-2].classList.toggle('ball');
          ballArray[num-1].classList.toggle('ball');
          num--;
          if(num == 1){
            buttonList[0].removeEventListener('click',prevFunction);
            buttonList[1].addEventListener('click', nextFunction );
            buttonList[0].setAttribute("disabled","true");
            buttonList[1].removeAttribute("disabled");
          }
        }
      }));

    </script>
  </body>

</html>
